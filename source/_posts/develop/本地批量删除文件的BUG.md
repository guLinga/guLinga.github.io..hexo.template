---
title: 云文档开发笔记-本地批量删除文件的BUG和路径修改BUG
date: 2022-11-12
categories: 
- 开发
tag: 
- 开发笔记
- 云文档
- BUG
---

## 云文档-本地批量删除文件的BUG和路径修改BUG

我测试的时候发现一个问题就是，当修改文件的时候，如果先监听着`删除`，然后再监听`新增`的话，由于删除和新增是一个hooks监听的数据，当删除后再执行新增后，删除过的数据会再次回来，因为是同一个hooks监听的，所以删除后的数据在新增里面不会删除成功，也就是新增拿到的还是删除前的数据。

于是我就想着把修改写上，但是又发现了一个问题，就是node监听文件的修改不是文件路径的修改而是文件内容的修改，这就麻烦了，因为我无法监听到文件的路径修改。试了好多种方法，都不行。慌了。

然后我测着侧着又发现一个问题，如果本地删除一个文件没啥问题，但是如果批量删除就会出现问题，于是我又想到一个问题，为什么批量新增没问题呢？我就开始排查两个的区别，发现在删除里面，因为对象的key值是id所以我无法通过`obj[key]`的方法拿到对应title的对象，所以就导致了我需要循环对象来做删除的操作，这就导致了时间的浪费，我怀疑就是时间太长了，导致全部都由一个hooks来监听删除了，然后我又看到了文件名的删除是正常的，这又验证了我的想法。

所以我接下来的任务就是先把文件名的对象给修改一下。看看可不可以。

至于监听修改路径那个bug，我先看看改好文件名对象后能不能解决，如果不行我再另想办法。